<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <title>Ê¨¢Ëøé - ResearchHelper</title>

    <!-- Á¨¨‰∏âÊñπÂõæÊ†á & ÊªöÂä®Êù° -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <link rel="stylesheet" href="scrollbar.css" />

    <style>
      /* ==================== ÈÄöÁî® ==================== */
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      html,
      body {
        height: 100%;
        font-family: "Segoe UI", sans-serif;
        transition: background-color 0.3s, color 0.3s;
      }

      body.light-mode {
        background: #f9fafc;
        color: #000;
      }
      body.dark-mode {
        background: #1e1e1e;
        color: #eee;
      }

      /* ==================== È°∂Ê†è (Êñ∞Â¢û) ==================== */
      .titlebar {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: 32px;
        display: flex;
        align-items: center;
        padding-left: 12px;
        background: linear-gradient(90deg, #000 0 72px, #f9fafc 72px);
        -webkit-app-region: drag;
        z-index: 100;
      }
      body.dark-mode .titlebar {
        background: linear-gradient(90deg, #000 0 72px, #1e1e1e 72px);
      }

      .window-controls {
        display: flex;
        gap: 10px;
      }
      .win-btn {
        width: 12px;
        height: 12px;
        border-radius: 50%;
        border: none;
        outline: none;
        cursor: pointer;
        -webkit-app-region: no-drag;
        transition: filter 0.15s;
      }
      .win-close {
        background: #ff5f57;
      }
      .win-min {
        background: #ffbd2e;
      }
      .win-max {
        background: #28c940;
      }
      .win-btn:hover {
        filter: brightness(1.15);
      }
      .win-close:hover {
        filter: brightness(1.3);
      }
      body.dark-mode .win-btn {
        filter: brightness(0.9);
      }
      body.dark-mode .win-btn:hover {
        filter: brightness(1.1);
      }
      body.dark-mode .win-close:hover {
        filter: brightness(1.25);
      }

      /* ==================== È°µÈù¢‰∏ª‰Ωì ==================== */
      .container {
        position: fixed; /* Ë¥¥Á¥ßÂõõËæπ */
        top: 32px; /* ËÖæÂá∫È°∂Ê†è */
        left: 0;
        right: 0;
        bottom: 0; /* ‚Üô ‰∏çÁïôÁºù */
        display: flex;
      }
      /* ‚Äî‚Äî ‰æßËæπÊ†è ‚Äî‚Äî */
      .sidebar {
        width: 72px;
        background: #000;
        padding: 20px 0;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        align-items: center;
        -webkit-app-region: drag;
      }
      .logo,
      .nav-links a,
      .footer {
        width: 40px;
        height: 40px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
        text-decoration: none;
        color: #fff;
        transition: background 0.2s, transform 0.2s, color 0.2s;
      }
      .logo {
        cursor: default;
        -webkit-app-region: drag;
      }
      .nav-links a,
      .footer {
        -webkit-app-region: no-drag;
        cursor: pointer;
      }
      .logo:hover,
      .nav-links a:hover,
      .footer:hover {
        background: #a2c9ef;
        transform: translateY(-2px);
      }
      .nav-links a.active {
        background: #5da3fa;
        color: #000;
      }
      body.dark-mode .nav-links a.active {
        background: #2e7ae5;
        color: #fff;
      }

      /* ‚Äî‚Äî Â∫ïÈÉ®ÊåâÈíÆÁªÑ ‚Äî‚Äî */
      .bottom-links {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 14px;
        position: relative;
      }
      .bottom-links::before {
        content: "";
        position: absolute;
        top: -22px;
        width: 32px;
        height: 1px;
        border-radius: 9999px;
        background: rgba(255, 255, 255, 0.12);
      }
      body.light-mode .bottom-links::before {
        background: rgba(0, 0, 0, 0.12);
      }
      .sidebar .footer {
        margin: 0 !important;
      }
      .pin-btn {
        background: transparent !important;
      }
      .pin-btn i {
        color: #fff;
        transition: color 0.25s, transform 0.25s;
      }
      .pin-btn.pin-active i {
        color: var(--accent, #3d7dff);
        transform: rotate(45deg);
      }

      /* ‚Äî‚Äî iframe ‚Äî‚Äî */
      .main {
        flex: 1;
      }
      iframe {
        width: 100%;
        height: 100%;
        border: none;
        display: block;
        background: #1e1e1e;
      }
      body.light-mode iframe {
        background: #f9fafc;
      }
    </style>
  </head>

  <body>
    <!-- È°∂Ê†è + ‰∏âÈîÆÔºàÊñ∞Â¢ûÔºâ -->
    <div class="titlebar">
      <div class="window-controls">
        <button id="btnMin" class="win-btn win-min" title="ÊúÄÂ∞èÂåñ"></button>
        <button
          id="btnMax"
          class="win-btn win-max"
          title="ÊúÄÂ§ßÂåñ / ËøòÂéü"
        ></button>
        <button id="btnClose" class="win-btn win-close" title="ÂÖ≥Èó≠"></button>
      </div>
    </div>

    <div class="container">
      <!-- ‰æßËæπÊ†è -->
      <div class="sidebar">
        <div class="logo" title="ResearchHelper">üìü</div>

        <div class="nav-links">
          <a data-src="./hotsearch.html" title="ÁÉ≠Êêú"
            ><i class="fa-solid fa-fire"></i
          ></a>
          <a data-src="settings.html" title="ËÆæÁΩÆ"
            ><i class="fa-solid fa-gear"></i
          ></a>
          <a id="btnPin" class="pin-btn" title="Á™óÂè£ÁΩÆÈ°∂"
            ><i class="fa-solid fa-thumbtack"></i
          ></a>
        </div>

        <div class="bottom-links">
          <a class="footer" data-src="about.html" title="ÂÖ≥‰∫é"
            ><i class="fa-solid fa-user-astronaut"></i
          ></a>
          <a id="btnExit" class="footer" title="ÈÄÄÂá∫"
            ><i class="fa-solid fa-right-from-bracket"></i
          ></a>
        </div>
      </div>

      <!-- ‰∏ªÂÜÖÂÆπ iframe -->
      <div class="main">
        <iframe id="mainFrame" src="./hotsearch.html"></iframe>
      </div>
    </div>

    <script>
      /* ========= ‰∏ªÈ¢òÂàùÂßãÂåñ ========= */
      const initTheme = () => {
        const t = localStorage.getItem("theme") || "light";
        document.body.classList.toggle("light-mode", t === "light");
        document.body.classList.toggle("dark-mode", t === "dark");
        document.getElementById("mainFrame").style.background =
          t === "dark" ? "#1e1e1e" : "#f9fafc";
      };
      initTheme();
      window.addEventListener("storage", (e) => {
        if (e.key === "theme") initTheme();
      });

      /* ========= ‰æßÊ†èÂØºËà™ ========= */
      const iframe = document.getElementById("mainFrame");
      const navLinks = document.querySelectorAll(".nav-links a[data-src]");
      const setActive = (link) =>
        navLinks.forEach((l) => l.classList.toggle("active", l === link));
      navLinks.forEach((l) => {
        l.addEventListener("click", (e) => {
          e.preventDefault();
          iframe.src = l.dataset.src;
          setActive(l);
        });
      });
      setActive(
        document.querySelector('.nav-links a[data-src="./hotsearch.html"]')
      );
      document.querySelector(".footer[data-src]").onclick = (e) => {
        e.preventDefault();
        iframe.src = e.currentTarget.dataset.src;
        setActive(null);
      };

      /* ========= ÁΩÆÈ°∂ / ÈÄÄÂá∫ ========= */
      document.getElementById("btnExit").onclick = (e) => {
        e.preventDefault();
        ipcRenderer?.send("app-exit");
      };
      const btnPin = document.getElementById("btnPin");
      btnPin.onclick = (e) => {
        e.preventDefault();
        window.electronAPI?.toggleTop();
      };
      window.electronAPI?.onTopState((isTop) => {
        btnPin.classList.toggle("pin-active", isTop);
      });

      /* ========= È°∂Ê†è‰∏âÈîÆ ========= */
      const api = window.electronAPI || {};
      document.getElementById("btnMin").onclick = () => api.winMin?.();
      document.getElementById("btnMax").onclick = () => api.winMaxToggle?.();
      document.getElementById("btnClose").onclick = () => api.winClose?.();

      /* ========= È¢ÑÂèñÂ≠êÈ°µÈù¢ ========= */
      ["hotsearch.html", "settings.html", "about.html"].forEach((u) =>
        fetch(u)
      );
    </script>
  </body>
</html>
