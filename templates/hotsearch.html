<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <!--#include virtual="theme-init.html" -->
    <meta charset="UTF-8" />
    <meta name=\"color-scheme\" content=\"light dark\">
    <title>ÂæÆÂçöÁÉ≠Êêú - ResearchHelper</title>
    <style>
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        background-color: #f2f2f7;
        color: #1c1c1e;
        max-width: 800px;
        margin: 32px auto;
        padding: 0 20px;
        transition: background-color 0.3s, color 0.3s;
      }

      body.dark-mode {
        background-color: #1c1c1e;
        color: #f2f2f7;
      }

      .top-bar {
        text-align: center;
        margin-bottom: 24px;
      }

      .hot-title {
        font-size: 26px;
        font-weight: 700;
        color: #ff453a;
        margin: 0;
      }

      body.dark-mode .hot-title {
        color: #ff9580;
      }

      .hot-item {
        border-radius: 12px;
        padding: 0;
        margin-bottom: 12px;
        overflow: hidden;
        transition: transform 0.2s ease;
        position: relative;
        z-index: 0;
        background: transparent;
      }

      .hot-item:hover {
        transform: scale(1.05);
        z-index: 20;
      }

      .card-link {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 12px 16px;
        text-decoration: none;
        background: rgba(255, 255, 255, 0.9);
        backdrop-filter: saturate(180%) blur(20px);
        border-radius: 12px;
        color: inherit;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.04);
        transition: background 0.2s ease;
      }

      .card-link:hover {
        background: rgba(255, 255, 255, 1);
      }

      body.dark-mode .card-link {
        background: rgba(36, 36, 38, 0.7);
        box-shadow: 0 1px 3px rgba(255, 255, 255, 0.04);
      }

      body.dark-mode .card-link:hover {
        background: rgba(58, 58, 60, 0.85);
      }

      .rank {
        font-size: 17px;
        font-weight: 600;
        margin-right: 10px;
        min-width: 28px;
        text-align: right;
        color: #888;
      }

      body.dark-mode .rank {
        color: #bbb;
      }

      .content {
        flex: 1;
      }

      .title {
        font-size: 16px;
        margin: 0;
        font-weight: 500;
        color: #1c1c1e;
      }

      body.dark-mode .title {
        color: #f2f2f7;
      }

      .meta {
        display: flex;
        align-items: center;
        gap: 6px;
        font-size: 13px;
        margin-left: 10px;
        white-space: nowrap;
      }

      .heat {
        color: #ff3b30;
        font-weight: 500;
      }

      body.dark-mode .heat {
        color: #ff6b61;
      }

      .label-icon {
        width: 20px;
        height: 20px;
        vertical-align: middle;
      }

      /* Ê®°Á≥äËÉåÊôØÂç°ÁâáÊïàÊûú
      .hotsearch-hovering .hot-item:not(:hover) {
        filter: blur(0px) brightness(1);
        transition: filter 0.2s ease;
      } */

      .footer {
        text-align: center;
        margin-top: 32px;
        color: #999;
        font-size: 13px;
      }

      body.dark-mode .footer {
        color: #777;
      }
    </style>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const theme = localStorage.getItem("theme") || "light";
        document.body.classList.add(theme + "-mode");

        const list = document.getElementById("hotsearch-list");

        // Ê∑ªÂä†ËÅöÁÑ¶Ê®°Á≥äÊïàÊûú
        list.addEventListener("mouseover", () => {
          list.classList.add("hotsearch-hovering");
        });
        list.addEventListener("mouseout", () => {
          list.classList.remove("hotsearch-hovering");
        });

        function loadHotsearch() {
          const backendUrl = "http://localhost:8080";
          fetch(`${backendUrl}/api/hotsearch`)
            .then((res) => res.json())
            .then((data) => {
              list.innerHTML = "";

              if (!data || data.length === 0) {
                list.innerHTML =
                  "<p style='text-align:center;color:#aaa;'>ÊöÇÊó†ÁÉ≠Êêú</p>";
                return;
              }
              data
                .filter((item) => !item.is_ad && item.word && item.num > 0)
                .forEach((item) => {
                  const div = document.createElement("div");
                  div.className = "hot-item";
                  const encodedWord = encodeURIComponent(item.word);

                  div.innerHTML = `
                  <a href="https://s.weibo.com/weibo?q=${encodedWord}" class="card-link" target="_self">
                    <div class="rank">${item.rank + 1}</div>
                    <div class="content">
                      <p class="title">${item.word}</p>
                    </div>
                    <div class="meta">
                      <span class="heat">üî• ${
                        item.num?.toLocaleString?.() || ""
                      }</span>
                      ${
                        item.icon
                          ? `<img class="label-icon" src="${item.icon}" alt="${item.icon_desc}" title="${item.icon_desc}" />`
                          : ""
                      }
                    </div>
                  </a>
                `;
                  list.appendChild(div);
                });
            })
            .catch((err) => {
              console.error("Âä†ËΩΩÂ§±Ë¥•Ôºö", err);
            });
        }

        loadHotsearch();
        setInterval(loadHotsearch, 30000);
      });
    </script>
  </head>

  <body>
    <div class="top-bar">
      <h1 class="hot-title">üî• ÂæÆÂçöÁÉ≠Êêú</h1>
    </div>

    <div id="hotsearch-list">
      <p style="text-align: center; color: #aaa">Âä†ËΩΩ‰∏≠...</p>
    </div>
  </body>
</html>
